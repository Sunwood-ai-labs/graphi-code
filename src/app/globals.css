@tailwind base;
@tailwind components;
@tailwind utilities;

/* CSSリセット */
html {
  box-sizing: border-box;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  height: 100%;
  scrollbar-width: thin;
  scrollbar-color: var(--current-text-secondary) var(--current-bg-secondary);
}

*,
*::before,
*::after {
  box-sizing: inherit;
}

body, h1, h2, h3, h4, h5, h6, p, ol, ul, figure, figcaption, blockquote, dl, dd {
  margin: 0;
}

ul[role='list'],
ol[role='list'] {
  list-style: none;
  padding: 0;
}

img,
picture,
video,
canvas,
svg {
  display: block;
  max-width: 100%;
}

input,
button,
textarea,
select {
  font: inherit;
}

/* 涼雅カラーパレット定義 */
:root {
    /* ライトテーマ「涼雅改」 */
    --primary-color: #3A5F73; /* 深みのある藍色系 */
    --secondary-color: #5F8A8B; /* やや彩度を抑えた青緑系 */
    --accent-color: #B6955D; /* 上品な金色系 */
    --neon-gold: #E6B422; /* 明るい金色 (アクセント) */
    --bg-main: #FAF8F2; /* 生成り色 */
    --bg-secondary: #EAE6DA; /* やや濃いめの生成り色 */
    --text-primary: #333333; /* 墨色に近い濃いグレー */
    --text-secondary: #666666; /* やや薄めのグレー */
    --border-color: #DDDDDD; /* 主張しすぎない薄いグレー */

    --primary-color-rgb: 58, 95, 115;
    --secondary-color-rgb: 95, 138, 139; /* Added for completeness */
    --accent-color-rgb: 182, 149, 93;
    --text-primary-rgb: 51, 51, 51; /* For box-shadow */
    --bg-main-rgb: 250, 248, 242; /* For navbar opacity */

    /* Alpha versions for theming */
    --current-primary-alpha-10: rgba(var(--primary-color-rgb), 0.1);
    --current-primary-alpha-20: rgba(var(--primary-color-rgb), 0.2);
    --current-primary-alpha-30: rgba(var(--primary-color-rgb), 0.3);
    --current-accent-alpha-20: rgba(var(--accent-color-rgb), 0.2);
    --current-accent-alpha-50: rgba(var(--accent-color-rgb), 0.5);

    /* テーマ切り替え用の共通変数 */
    --current-primary: var(--primary-color);
    --current-secondary: var(--secondary-color);
    --current-accent: var(--accent-color);
    --current-neon: var(--neon-gold);
    --current-bg-main: var(--bg-main);
    --current-bg-secondary: var(--bg-secondary);
    --current-text-primary: var(--text-primary);
    --current-text-secondary: var(--text-secondary);
    --current-border-color: var(--border-color);
    --current-bg-main-rgb: var(--bg-main-rgb); /* Ensure this was added in previous step */

    /* 和モダンフォント */
    --font-sans-jp: "Noto Sans JP", "M PLUS Rounded 1c", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
    --font-serif-jp: "Shippori Mincho", "Kaisei Decol", Georgia, Cambria, "Times New Roman", Times, serif;
}

/* ダークテーマ「月夜」 */
[data-theme="dark"] {
    --primary-color: #B6955D; /* ライトのアクセントカラーをメインに */
    --secondary-color: #8A9BA8; /* 銀鼠色 */
    --accent-color: #734A5F; /* 深みのある赤紫 */
    --neon-gold: #F0C27B; /* 明るい金色 */
    --bg-main: #1A222C; /* 非常に濃い藍色 */
    --bg-secondary: #2A3440; /* やや明るい濃い灰色 */
    --text-primary: #EAEAEA; /* 明るい生成り色 */
    --text-secondary: #CCCCCC; /* やや暗めの白に近いグレー */
    --border-color: #444444; /* 背景に馴染む濃いグレー */

    --primary-color-rgb: 182, 149, 93;
    --secondary-color-rgb: 138, 155, 168; /* Added for completeness */
    --accent-color-rgb: 115, 74, 95;
    --text-primary-rgb: 234, 234, 234; /* For box-shadow */
    --bg-main-rgb: 26, 34, 44; /* For navbar opacity */

    /* Alpha versions for dark theme */
    --current-primary-alpha-10: rgba(var(--primary-color-rgb), 0.1);
    --current-primary-alpha-20: rgba(var(--primary-color-rgb), 0.2);
    --current-primary-alpha-30: rgba(var(--primary-color-rgb), 0.3);
    --current-accent-alpha-20: rgba(var(--accent-color-rgb), 0.2);
    --current-accent-alpha-50: rgba(var(--accent-color-rgb), 0.5);

    /* Update current variables for dark theme */
    --current-primary: var(--primary-color);
    --current-secondary: var(--secondary-color);
    --current-accent: var(--accent-color);
    --current-neon: var(--neon-gold);
    --current-bg-main: var(--bg-main);
    --current-bg-secondary: var(--bg-secondary);
    --current-text-primary: var(--text-primary);
    --current-text-secondary: var(--text-secondary);
    --current-border-color: var(--border-color);
}

/* スムーズなテーマ切り替えアニメーション */
* {
    transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
}

/* 基本設定 */
body {
    /* margin: 0; Tailwind handles this */
    padding: 0; /* Ensure no default padding */
    font-family: var(--font-sans-jp); /* 和モダンフォントを適用 */
    background-color: var(--current-bg-main);
    color: var(--current-text-primary);
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

/* Navbar styling */
.navbar {
    position: sticky;
    top: 0;
    left: 0;
    right: 0;
    z-index: 50;
    background: rgba(var(--current-bg-main-rgb), 0.85); /* Updated to use the new variable */
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    padding: 1rem 1.5rem; /*上下のパディングを増やす*/
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 1px 3px rgba(var(--current-text-primary-rgb), 0.08); /*より繊細な影*/
    color: var(--current-text-primary);
    border-bottom: 1px solid var(--current-border-color);
}
/* Remove theme-specific overrides for navbar background as it's now handled by --current-bg-main-rgb */

.nav-brand {
    color: var(--current-primary);
    font-size: 1.5rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.nav-buttons {
    display: flex;
    gap: 0.75rem;
}

.nav-btn {
    background: var(--current-accent);
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 0.75rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.375rem;
    font-family: "M PLUS Rounded 1c", sans-serif;
    font-size: 0.9rem;
    font-weight: 500;
}
.nav-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

/* Main content layout */
.main-content-area {
    flex-grow: 1;
    display: flex;
}

.editor-preview-pane {
  border-color: var(--current-border-color) !important; /* Override Tailwind if necessary */
  background-color: var(--current-bg-main) !important;
  /* h-full is applied in component, ensure it works with flex parent */
}
.editor-preview-pane.border-r { /* Specifically target the one with border-r if needed */
    border-right-width: 1px;
}


.section-header {
    font-size: 1.125rem;
    font-weight: 600;
    padding: 1rem;
    background-color: var(--current-bg-secondary);
    border-bottom: 1px solid var(--current-border-color);
    color: var(--current-text-primary);
    font-family: "Kaisei Decol", serif;
}

/* CodeMirror Editor Theming */
/* Wrapper for HtmlEditor component if needed, or style CodeMirror's own wrapper */
/* The .cm-editor class is usually the outermost CodeMirror generated div */
.cm-editor {
    height: 100% !important; /* Ensure it fills container */
    outline: none !important; /* Remove default outline */
}

/* Live Preview Area */
.live-preview-container { /* Applied to the div wrapping the LivePreview component's output div */
  background-color: var(--current-bg-main); /* Or --current-bg-secondary for contrast */
  color: var(--current-text-primary);
  border: 1px solid var(--current-border-color);
  /* padding is on the inner div now in LivePreview.tsx */
  height: 100%;
  overflow: auto;
}

/* Visual cue for contentEditable elements in LivePreview */
[data-editable="true"][contenteditable="true"] {
  outline: 1px dashed var(--current-accent) !important;
  cursor: text !important;
  /* transition プロパティに box-shadow を追加 */
  transition: outline 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}
[data-editable="true"][contenteditable="true"]:hover {
  outline-color: var(--current-primary) !important; /* Keep dashed outline for hover */
}
[data-editable="true"][contenteditable="true"]:focus {
  outline: none !important; /* Ensure no default outline */
  box-shadow: 0 0 0 3px rgba(var(--current-primary-rgb), 0.4); /* Use primary color with alpha */
  border-radius: 2px; /* Optional: add a slight radius to the shadow's shape */
  /* transition プロパティに box-shadow を追加 (重複するが、個別指定の意図を明確に) */
  transition: outline 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}

/* Default styles for HTML elements in Live Preview (Wa-Modern aesthetic) */
.live-preview-container h1, .live-preview-container h2, .live-preview-container h3, .live-preview-container h4, .live-preview-container h5, .live-preview-container h6 {
  font-family: "Kaisei Decol", serif;
  color: var(--current-primary);
  margin-top: 1.5em;
  margin-bottom: 0.75em;
  line-height: 1.3;
}
.live-preview-container h1 { font-size: 2em; } /* Slightly reduced from 2.25 */
.live-preview-container h2 { font-size: 1.75em; } /* Slightly reduced from 1.875 */
.live-preview-container h3 { font-size: 1.375em; } /* Slightly reduced from 1.5 */

.live-preview-container p {
  font-family: "M PLUS Rounded 1c", sans-serif;
  color: var(--current-text-primary);
  line-height: 1.7;
  margin-bottom: 1em;
}

.live-preview-container a {
  color: var(--current-accent);
  text-decoration: none;
  border-bottom: 1px dashed var(--current-accent);
}
.live-preview-container a:hover {
  color: var(--current-primary);
  border-bottom-style: solid;
}

.live-preview-container ul, .live-preview-container ol {
  margin-left: 1.5em; /* Reduced from 2em */
  margin-bottom: 1em;
  padding-left: 0.5em;
}
.live-preview-container ul li::marker { color: var(--current-accent); }
.live-preview-container ol li::marker { color: var(--current-accent); }

.live-preview-container li {
  margin-bottom: 0.5em;
  line-height: 1.6;
  padding-left: 0.5em; /* Space out marker a bit */
}

.live-preview-container blockquote {
  border-left: 4px solid var(--current-accent); /* ボーダーを太く */
  padding: 0.8em 1.2em;
  margin: 1.5em 0;
  font-style: normal;
  color: var(--current-text-secondary);
  background-color: var(--current-primary-alpha-10); /* プライマリカラーの薄い背景 */
  border-radius: 0 8px 8px 0; /* 角丸を少し大きく */
}

[data-theme="dark"] .live-preview-container blockquote {
  background-color: rgba(var(--accent-color-rgb), 0.15); /* ダークテーマのアクセントカラーの15% */
}

.live-preview-container pre, .live-preview-container code:not(pre code) {
  font-family: 'Source Code Pro', Menlo, Monaco, Consolas, 'Courier New', monospace;
  background-color: var(--current-bg-secondary);
  color: var(--current-text-primary); /* Ensure text color contrasts with bg */
  padding: 0.2em 0.4em;
  border-radius: 3px;
  font-size: 0.9em;
  border: 1px solid var(--current-border-color); /* Border for inline code */
}
.live-preview-container pre {
  padding: 1em;
  overflow-x: auto;
  border-radius: 4px; /* Consistent border radius */
}
.live-preview-container code {
  word-wrap: break-word;
}


.live-preview-container table {
  width: 100%;
  border-collapse: separate; /* Changed for spacing and rounded corners */
  border-spacing: 0;
  margin-bottom: 1em;
  font-family: "M PLUS Rounded 1c", sans-serif;
  border: 1px solid var(--current-border-color);
  border-radius: 4px;
}
.live-preview-container th, .live-preview-container td {
  border-bottom: 1px solid var(--current-border-color);
  padding: 0.75em 1em;
  text-align: left;
}
.live-preview-container tr:last-child td {
    border-bottom: none;
}
.live-preview-container th {
  background-color: var(--current-bg-secondary);
  color: var(--current-primary);
  font-weight: bold;
  font-family: "Kaisei Decol", serif; /* Headers in Kaisei */
  border-bottom-width: 2px; /* Stronger border for header row */
}


.live-preview-container hr {
  border: none;
  border-top: 2px dashed var(--current-border-color); /* Dashed HR */
  margin: 2em 0;
}

/* Font classes from example (optional, can be applied directly in components) */
.kaisei-decol-regular { font-family: "Kaisei Decol", serif; font-weight: 400; font-style: normal; }
.kaisei-decol-bold { font-family: "Kaisei Decol", serif; font-weight: 700; font-style: normal; }
.m-plus-rounded-1c-regular { font-family: "M PLUS Rounded 1c", sans-serif; font-weight: 400; font-style: normal; }
.m-plus-rounded-1c-bold { font-family: "M PLUS Rounded 1c", sans-serif; font-weight: 700; font-style: normal; }

/* Scrollbar theming for Webkit browsers */
::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-track { background: var(--current-bg-secondary); border-radius: 5px; }
::-webkit-scrollbar-thumb { background: var(--current-text-secondary); border-radius: 5px; border: 2px solid var(--current-bg-secondary); }
::-webkit-scrollbar-thumb:hover { background: var(--current-primary); }
::-webkit-scrollbar-corner { background: transparent; }

/* CodeMirror specific syntax highlighting (ensure these are defined if not using a pre-built CM theme that defines them) */
/* These are examples; a full CodeMirror theme has many more selectors.
   The EditorView.theme in HtmlEditor.tsx provides the base theming.
   These specific token styles supplement it or can be part of a larger custom CM theme object. */
.cm-keyword { color: var(--current-accent) !important; }
.cm-atom { color: var(--current-secondary) !important; }
.cm-number { color: #AE81FF !important; } /* Using a distinct color for numbers */
.cm-def { color: var(--current-text-primary) !important; font-weight: bold; }
.cm-variable { color: var(--current-text-primary) !important; }
.cm-variable-2 { color: var(--current-primary) !important; }
.cm-variable-3, .cm-type { color: #FD971F !important; } /* Orange for types/var-3 */
.cm-property { color: var(--current-secondary) !important; font-style: italic; }
.cm-operator { color: var(--current-text-secondary) !important; }
.cm-comment { color: var(--current-text-secondary) !important; font-style: italic; }
.cm-string { color: #A6E22E !important; } /* Green for strings */
.cm-string-2 { color: var(--current-accent) !important; } /* Different string type */
.cm-meta { color: #75715E !important; } /* Gray for meta tags */
.cm-qualifier { color: #525252 !important; }
.cm-builtin { color: var(--current-primary) !important; font-weight: bold; }
.cm-bracket { color: var(--current-text-secondary) !important; }
.cm-tag { color: #F92672 !important; } /* Pink for HTML tags */
.cm-attribute { color: #66D9EF !important; } /* Cyan for HTML attributes */
.cm-hr { color: var(--current-border-color) !important; }
.cm-link { color: var(--current-accent) !important; text-decoration: underline !important; }
.cm-error { background-color: rgba(255,0,0,0.2) !important; color: red !important; }

/* Responsive adjustments */
@media (max-width: 767px) { /* Corresponds to Tailwind's `md` breakpoint, affects screens smaller than 768px */
  .navbar {
    padding: 0.75rem 1rem; /* Reduce padding on smaller screens */
  }

  .nav-brand {
    font-size: 1.25rem; /* Reduce brand font size */
  }

  .nav-buttons {
    gap: 0.5rem; /* Reduce gap between buttons */
  }

  .nav-btn {
    padding: 0.5rem 0.8rem; /* Reduce button padding */
    font-size: 0.8rem; /* Reduce button font size */
    gap: 0.3rem; /* Reduce gap in button */
  }

  .nav-btn i { /* If icons are used in nav buttons, adjust their size */
    font-size: 0.9em;
  }

  .section-header {
    font-size: 1rem; /* Reduce section header font size */
    padding: 0.75rem 1rem;
  }

  .section-header h2 { /* If h2 is directly inside section-header */
      font-size: 1rem; /* Ensure consistency */
  }

  /* Live Preview font size adjustments for smaller screens */
  .live-preview-container h1 { font-size: 1.8em; }
  .live-preview-container h2 { font-size: 1.5em; }
  .live-preview-container h3 { font-size: 1.25em; }
  .live-preview-container h4 { font-size: 1.1em; }
  .live-preview-container p {
    font-size: 0.9rem;
    line-height: 1.7; /* Adjust line height for smaller paragraph font */
  }

  /* Adjust editor and preview pane heights for stacked view if necessary */
  /* This might be better handled by ensuring parent containers allow content to define height (h-auto already applied in page.tsx) */
  .editor-preview-pane {
      min-height: 300px; /* Ensure panes have a minimum height when stacked */
  }
  .editor-component-wrapper, .live-preview-wrapper {
      flex-grow: 1; /* Allow editor/preview content to fill the pane */
      overflow-y: auto; /* Add scroll if content overflows */
  }
}
