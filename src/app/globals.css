@tailwind base;
@tailwind components;
@tailwind utilities;

/* CSSリセット */
html {
  box-sizing: border-box;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  height: 100%;
  scrollbar-width: thin;
  scrollbar-color: var(--current-text-secondary) var(--current-bg-secondary);
}

*,
*::before,
*::after {
  box-sizing: inherit;
}

body, h1, h2, h3, h4, h5, h6, p, ol, ul, figure, figcaption, blockquote, dl, dd {
  margin: 0;
}

ul[role='list'],
ol[role='list'] {
  list-style: none;
  padding: 0;
}

img,
picture,
video,
canvas,
svg {
  display: block;
  max-width: 100%;
}

input,
button,
textarea,
select {
  font: inherit;
}

/* 涼雅カラーパレット定義 */
:root {
    /* ライトテーマ「涼雅」 */
    --primary-color: #025E73; /* 深い青緑 */
    --secondary-color: #038C8C; /* 青緑 */
    --accent-color: #04BFAD; /* 明るい青緑 */
    --neon-gold: #F2C166; /* 金色 */
    --bg-main: #FAFAFA; /* 明るい背景 */
    --bg-secondary: #F2F2F2; /* やや暗い背景 */
    --text-primary: #024A5C; /* 濃い青緑文字 */
    --text-secondary: #026B73; /* 青緑文字 */
    --border-color: #E0E0E0; /* ボーダー色 */

    --primary-color-rgb: 2, 94, 115;
    --secondary-color-rgb: 3, 140, 140;
    --accent-color-rgb: 4, 191, 173;
    --neon-gold-rgb: 242, 193, 102;
    --text-primary-rgb: 2, 74, 92;
    --bg-main-rgb: 250, 250, 250;

    /* Alpha versions for theming */
    --current-primary-alpha-10: rgba(var(--primary-color-rgb), 0.1);
    --current-primary-alpha-20: rgba(var(--primary-color-rgb), 0.2);
    --current-primary-alpha-30: rgba(var(--primary-color-rgb), 0.3);
    --current-accent-alpha-20: rgba(var(--accent-color-rgb), 0.2);
    --current-accent-alpha-50: rgba(var(--accent-color-rgb), 0.5);

    /* テーマ切り替え用の共通変数 */
    --current-primary: var(--primary-color);
    --current-secondary: var(--secondary-color);
    --current-accent: var(--accent-color);
    --current-neon: var(--neon-gold);
    --current-bg-main: var(--bg-main);
    --current-bg-secondary: var(--bg-secondary);
    --current-text-primary: var(--text-primary);
    --current-text-secondary: var(--text-secondary);
    --current-border-color: var(--border-color);
    --current-bg-main-rgb: var(--bg-main-rgb); /* Ensure this was added in previous step */

    /* 和モダンフォント */
    --font-sans-jp: "Noto Sans JP", "M PLUS Rounded 1c", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
    --font-serif-jp: "Shippori Mincho", "Kaisei Decol", Georgia, Cambria, "Times New Roman", Times, serif;
}

/* ダークテーマ「夜涼」 */
[data-theme="dark"] {
    --primary-color: #04BFAD; /* 明るい青緑 */
    --secondary-color: #F2C166; /* 金色 */
    --accent-color: #038C8C; /* 青緑 */
    --neon-gold: #66D9EF; /* 明るいシアン */
    --bg-main: #0A1A1F; /* 非常に濃い青 */
    --bg-secondary: #1A2F35; /* やや明るい濃い青 */
    --text-primary: #E8F4F8; /* 明るい青白 */
    --text-secondary: #B8D4E3; /* やや暗い青白 */
    --border-color: #2A3E46; /* 濃い青グレー */

    --primary-color-rgb: 4, 191, 173;
    --secondary-color-rgb: 242, 193, 102;
    --accent-color-rgb: 3, 140, 140;
    --neon-gold-rgb: 102, 217, 239;
    --text-primary-rgb: 232, 244, 248;
    --bg-main-rgb: 10, 26, 31;

    /* Alpha versions for dark theme */
    --current-primary-alpha-10: rgba(var(--primary-color-rgb), 0.1);
    --current-primary-alpha-20: rgba(var(--primary-color-rgb), 0.2);
    --current-primary-alpha-30: rgba(var(--primary-color-rgb), 0.3);
    --current-accent-alpha-20: rgba(var(--accent-color-rgb), 0.2);
    --current-accent-alpha-50: rgba(var(--accent-color-rgb), 0.5);

    /* Update current variables for dark theme */
    --current-primary: var(--primary-color);
    --current-secondary: var(--secondary-color);
    --current-accent: var(--accent-color);
    --current-neon: var(--neon-gold);
    --current-bg-main: var(--bg-main);
    --current-bg-secondary: var(--bg-secondary);
    --current-text-primary: var(--text-primary);
    --current-text-secondary: var(--text-secondary);
    --current-border-color: var(--border-color);
}

/* スムーズなテーマ切り替えアニメーション */
* {
    transition: background-color 0.5s ease, color 0.5s ease, border-color 0.5s ease, transform 0.3s ease;
}

/* アニメーション */
@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
}

@keyframes sparkle {
    0% { opacity: 0.3; transform: scale(1); }
    100% { opacity: 0.7; transform: scale(1.1); }
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

/* フローティングエフェクト */
.section-header i {
    animation: float 3s ease-in-out infinite;
    display: inline-block;
}

/* フェードインアニメーション */
.editor-preview-pane {
    animation: fadeIn 0.6s ease-out;
}

.editor-preview-pane:nth-child(2) {
    animation-delay: 0.2s;
}

/* 基本設定 */
body {
    /* margin: 0; Tailwind handles this */
    padding: 0; /* Ensure no default padding */
    font-family: var(--font-sans-jp); /* 和モダンフォントを適用 */
    background-color: var(--current-bg-main);
    color: var(--current-text-primary);
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

/* Navbar styling */
.navbar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 9999;
    background: rgba(255,255,255,0.95);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    padding: 12px 24px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    color: var(--current-text-primary);
    transition: all 0.3s ease;
}

[data-theme="dark"] .navbar {
    background: rgba(10,26,31,0.95) !important;
}
/* Remove theme-specific overrides for navbar background as it's now handled by --current-bg-main-rgb */

.nav-brand {
    color: var(--current-primary);
    font-size: 1.5rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.nav-buttons {
    display: flex;
    gap: 0.75rem;
}

.nav-btn {
    background: var(--current-accent);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 6px;
    font-family: "M PLUS Rounded 1c", sans-serif;
    font-size: 0.9rem;
    font-weight: 500;
}

.nav-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

.nav-btn-secondary {
    background: var(--current-primary) !important;
}

/* Main content layout */
.main-content-area {
    flex-grow: 1;
    display: flex;
    margin-top: 80px; /* Navbar height offset */
    background: linear-gradient(135deg, var(--current-bg-main), var(--current-bg-secondary));
    position: relative;
    overflow: hidden;
}

/* 青海波パターン背景 */
.main-content-area::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath d='M0,50 Q25,25 50,50 T100,50' stroke='%23038C8C' fill='none' opacity='0.08'/%3E%3Cpath d='M0,60 Q25,35 50,60 T100,60' stroke='%23025E73' fill='none' opacity='0.06'/%3E%3C/svg%3E");
    z-index: 0;
}

[data-theme="dark"] .main-content-area::before {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='20' cy='20' r='1' fill='%23F2C166' opacity='0.6'/%3E%3Ccircle cx='80' cy='30' r='0.5' fill='%2366D9EF' opacity='0.8'/%3E%3Ccircle cx='60' cy='70' r='0.8' fill='%2304BFAD' opacity='0.7'/%3E%3Ccircle cx='30' cy='80' r='0.6' fill='%23038C8C' opacity='0.5'/%3E%3C/svg%3E");
}

.editor-preview-pane {
  border-color: var(--current-border-color) !important;
  background: rgba(255,255,255,0.9) !important;
  backdrop-filter: blur(5px);
  border-radius: 15px;
  margin: 20px 10px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.1);
  z-index: 2;
  position: relative;
  overflow: hidden;
}

[data-theme="dark"] .editor-preview-pane {
    background: rgba(26,47,53,0.9) !important;
}

.editor-preview-pane.border-r {
    border-right: 1px solid var(--current-border-color);
    border-radius: 15px 0 0 15px;
    margin-right: 0;
}


.section-header {
    font-size: 1.2rem;
    font-weight: 700;
    padding: 1rem 1.5rem;
    background: linear-gradient(135deg, var(--current-primary), var(--current-secondary));
    color: white;
    font-family: "Kaisei Decol", serif;
    border-radius: 15px 15px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

/* CodeMirror Editor Theming */
.cm-editor {
    height: 100% !important;
    outline: none !important;
    border-radius: 0 0 15px 15px;
    overflow: hidden;
    background: var(--current-bg-secondary) !important;
}

.editor-component-wrapper {
    border-radius: 0 0 15px 15px;
    overflow: hidden;
    background: var(--current-bg-secondary);
}

/* Live Preview Area */
.live-preview-wrapper {
  background-color: var(--current-bg-main);
  color: var(--current-text-primary);
  border-radius: 0 0 15px 15px;
  height: 100%;
  overflow: auto;
  padding: 20px;
}

/* Visual cue for contentEditable elements in LivePreview */
[data-editable="true"][contenteditable="true"] {
  outline: 1px dashed var(--current-accent) !important;
  cursor: text !important;
  /* transition プロパティに box-shadow を追加 */
  transition: outline 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}
[data-editable="true"][contenteditable="true"]:hover {
  outline-color: var(--current-primary) !important; /* Keep dashed outline for hover */
}
[data-editable="true"][contenteditable="true"]:focus {
  outline: none !important; /* Ensure no default outline */
  box-shadow: 0 0 0 3px rgba(var(--current-primary-rgb), 0.4); /* Use primary color with alpha */
  border-radius: 2px; /* Optional: add a slight radius to the shadow's shape */
  /* transition プロパティに box-shadow を追加 (重複するが、個別指定の意図を明確に) */
  transition: outline 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}

/* Default styles for HTML elements in Live Preview (Wa-Modern aesthetic) */
.live-preview-container h1, .live-preview-container h2, .live-preview-container h3, .live-preview-container h4, .live-preview-container h5, .live-preview-container h6 {
  font-family: "Kaisei Decol", serif;
  color: var(--current-primary);
  margin-top: 1.5em;
  margin-bottom: 0.75em;
  line-height: 1.3;
}
.live-preview-container h1 { font-size: 2em; } /* Slightly reduced from 2.25 */
.live-preview-container h2 { font-size: 1.75em; } /* Slightly reduced from 1.875 */
.live-preview-container h3 { font-size: 1.375em; } /* Slightly reduced from 1.5 */

.live-preview-container p {
  font-family: "M PLUS Rounded 1c", sans-serif;
  color: var(--current-text-primary);
  line-height: 1.7;
  margin-bottom: 1em;
}

.live-preview-container a {
  color: var(--current-accent);
  text-decoration: none;
  border-bottom: 1px dashed var(--current-accent);
}
.live-preview-container a:hover {
  color: var(--current-primary);
  border-bottom-style: solid;
}

.live-preview-container ul, .live-preview-container ol {
  margin-left: 1.5em; /* Reduced from 2em */
  margin-bottom: 1em;
  padding-left: 0.5em;
}
.live-preview-container ul li::marker { color: var(--current-accent); }
.live-preview-container ol li::marker { color: var(--current-accent); }

.live-preview-container li {
  margin-bottom: 0.5em;
  line-height: 1.6;
  padding-left: 0.5em; /* Space out marker a bit */
}

.live-preview-container blockquote {
  border-left: 4px solid var(--current-accent); /* ボーダーを太く */
  padding: 0.8em 1.2em;
  margin: 1.5em 0;
  font-style: normal;
  color: var(--current-text-secondary);
  background-color: var(--current-primary-alpha-10); /* プライマリカラーの薄い背景 */
  border-radius: 0 8px 8px 0; /* 角丸を少し大きく */
}

[data-theme="dark"] .live-preview-container blockquote {
  background-color: rgba(var(--accent-color-rgb), 0.15); /* ダークテーマのアクセントカラーの15% */
}

.live-preview-container pre, .live-preview-container code:not(pre code) {
  font-family: 'Source Code Pro', Menlo, Monaco, Consolas, 'Courier New', monospace;
  background-color: var(--current-bg-secondary);
  color: var(--current-text-primary); /* Ensure text color contrasts with bg */
  padding: 0.2em 0.4em;
  border-radius: 3px;
  font-size: 0.9em;
  border: 1px solid var(--current-border-color); /* Border for inline code */
}
.live-preview-container pre {
  padding: 1em;
  overflow-x: auto;
  border-radius: 4px; /* Consistent border radius */
}
.live-preview-container code {
  word-wrap: break-word;
}


.live-preview-container table {
  width: 100%;
  border-collapse: separate; /* Changed for spacing and rounded corners */
  border-spacing: 0;
  margin-bottom: 1em;
  font-family: "M PLUS Rounded 1c", sans-serif;
  border: 1px solid var(--current-border-color);
  border-radius: 4px;
}
.live-preview-container th, .live-preview-container td {
  border-bottom: 1px solid var(--current-border-color);
  padding: 0.75em 1em;
  text-align: left;
}
.live-preview-container tr:last-child td {
    border-bottom: none;
}
.live-preview-container th {
  background-color: var(--current-bg-secondary);
  color: var(--current-primary);
  font-weight: bold;
  font-family: "Kaisei Decol", serif; /* Headers in Kaisei */
  border-bottom-width: 2px; /* Stronger border for header row */
}


.live-preview-container hr {
  border: none;
  border-top: 2px dashed var(--current-border-color); /* Dashed HR */
  margin: 2em 0;
}

/* Font classes from example (optional, can be applied directly in components) */
.kaisei-decol-regular { font-family: "Kaisei Decol", serif; font-weight: 400; font-style: normal; }
.kaisei-decol-bold { font-family: "Kaisei Decol", serif; font-weight: 700; font-style: normal; }
.m-plus-rounded-1c-regular { font-family: "M PLUS Rounded 1c", sans-serif; font-weight: 400; font-style: normal; }
.m-plus-rounded-1c-bold { font-family: "M PLUS Rounded 1c", sans-serif; font-weight: 700; font-style: normal; }

/* Scrollbar theming for Webkit browsers */
::-webkit-scrollbar { width: 10px; height: 10px; }
::-webkit-scrollbar-track { background: var(--current-bg-secondary); border-radius: 5px; }
::-webkit-scrollbar-thumb { background: var(--current-text-secondary); border-radius: 5px; border: 2px solid var(--current-bg-secondary); }
::-webkit-scrollbar-thumb:hover { background: var(--current-primary); }
::-webkit-scrollbar-corner { background: transparent; }

/* CodeMirror specific syntax highlighting (ensure these are defined if not using a pre-built CM theme that defines them) */
/* These are examples; a full CodeMirror theme has many more selectors.
   The EditorView.theme in HtmlEditor.tsx provides the base theming.
   These specific token styles supplement it or can be part of a larger custom CM theme object. */
.cm-keyword { color: var(--current-accent) !important; }
.cm-atom { color: var(--current-secondary) !important; }
.cm-number { color: #AE81FF !important; } /* Using a distinct color for numbers */
.cm-def { color: var(--current-text-primary) !important; font-weight: bold; }
.cm-variable { color: var(--current-text-primary) !important; }
.cm-variable-2 { color: var(--current-primary) !important; }
.cm-variable-3, .cm-type { color: #FD971F !important; } /* Orange for types/var-3 */
.cm-property { color: var(--current-secondary) !important; font-style: italic; }
.cm-operator { color: var(--current-text-secondary) !important; }
.cm-comment { color: var(--current-text-secondary) !important; font-style: italic; }
.cm-string { color: #A6E22E !important; } /* Green for strings */
.cm-string-2 { color: var(--current-accent) !important; } /* Different string type */
.cm-meta { color: #75715E !important; } /* Gray for meta tags */
.cm-qualifier { color: #525252 !important; }
.cm-builtin { color: var(--current-primary) !important; font-weight: bold; }
.cm-bracket { color: var(--current-text-secondary) !important; }
.cm-tag { color: #F92672 !important; } /* Pink for HTML tags */
.cm-attribute { color: #66D9EF !important; } /* Cyan for HTML attributes */
.cm-hr { color: var(--current-border-color) !important; }
.cm-link { color: var(--current-accent) !important; text-decoration: underline !important; }
.cm-error { background-color: rgba(255,0,0,0.2) !important; color: red !important; }

/* Responsive adjustments */
@media (max-width: 768px) {
  .navbar {
    padding: 10px 16px;
  }

  .nav-brand {
    font-size: 1.2rem;
  }

  .nav-buttons {
    gap: 8px;
  }

  .nav-btn {
    padding: 6px 12px;
    font-size: 0.8rem;
    gap: 4px;
  }

  .nav-btn span {
    display: none; /* Hide text on mobile, show only icons */
  }

  .main-content-area {
    margin-top: 60px;
    flex-direction: column;
  }

  .editor-preview-pane {
    margin: 10px;
    width: calc(100% - 20px);
    min-height: 400px;
  }

  .editor-preview-pane.border-r {
    border-right: none;
    border-radius: 15px;
    margin-right: 10px;
  }

  .section-header {
    font-size: 1rem;
    padding: 0.8rem 1rem;
  }

  .section-header h2 {
    font-size: 1rem;
  }

  .live-preview-wrapper {
    padding: 15px;
  }

  .live-preview-wrapper h1 { font-size: 1.8em; }
  .live-preview-wrapper h2 { font-size: 1.5em; }
  .live-preview-wrapper h3 { font-size: 1.25em; }
  .live-preview-wrapper p {
    font-size: 0.9rem;
    line-height: 1.6;
  }
}
